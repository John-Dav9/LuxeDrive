<div class="owner-bookings-container">
  <div class="bookings-header">
    <%= link_to "← Retour", cars_path, class: "back-link" %>
    <h1 class="bookings-title">Mes Réservations</h1>
  </div>

  <% if @owner_bookings.any? %>
    <div class="bookings-grid">
      <% @owner_bookings.each do |booking| %>
        <div class="booking-card">
          <div class="booking-card-image">
            <% if booking.car.photos.attached? %>
              <%= image_tag booking.car.photos.first, alt: "#{booking.car.brand} #{booking.car.model}" %>
            <% else %>
              <div class="placeholder-image">
                <i class="fas fa-car"></i>
              </div>
            <% end %>
            
            <div class="status-badge" data-status="<%= booking.status %>">
              <%= I18n.t("activerecord.attributes.booking.statuses.#{booking.status}", default: booking.status) %>
            </div>
          </div>

          <div class="booking-card-content">
            <div class="car-info">
              <h3><%= booking.car.brand %> <span><%= booking.car.model %></span></h3>
              <p class="location">
                <i class="fas fa-map-marker-alt"></i>
                <%= booking.car.address %>
              </p>
            </div>

            <div class="booking-details">
              <div class="detail-row">
                <span class="detail-label">Locataire :</span>
                <span class="detail-value"><%= booking.user.first_name %> <%= booking.user.last_name %></span>
              </div>

              <div class="detail-row">
                <span class="detail-label">Email :</span>
                <span class="detail-value"><%= booking.user.email %></span>
              </div>

              <div class="detail-row">
                <span class="detail-label">Arrivée :</span>
                <span class="detail-value"><%= l(booking.checkin_date, format: :short) %></span>
              </div>

              <div class="detail-row">
                <span class="detail-label">Départ :</span>
                <span class="detail-value"><%= l(booking.checkout_date, format: :short) %></span>
              </div>

              <div class="detail-row duration">
                <span class="detail-label">Durée :</span>
                <span class="detail-value"><%= (booking.checkout_date - booking.checkin_date).to_i %> jour(s)</span>
              </div>

              <div class="detail-row total">
                <span class="detail-label">Montant :</span>
                <span class="detail-value"><%= number_with_precision(booking.car.price * (booking.checkout_date - booking.checkin_date).to_i, precision: 0) %> €</span>
              </div>
            </div>

            <div class="booking-actions">
              <%= link_to "Voir détails", booking_path(booking), class: "btn btn-secondary btn-sm" %>
              <% if booking.status == "pending" %>
                <%= link_to "Accepter", accept_booking_path(booking), data: { turbo_method: :patch }, class: "btn btn-success btn-sm" %>
                <%= link_to "Refuser", reject_booking_path(booking), data: { turbo_method: :patch }, class: "btn btn-danger btn-sm" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Pagination -->
    <div class="pagination-wrapper">
      <%= paginate @owner_bookings %>
    </div>
  <% else %>
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-calendar-times"></i>
      </div>
      <h2>Aucune réservation</h2>
      <p>Vous n'avez pas encore reçu de réservations pour vos voitures.</p>
      <%= link_to "Ajouter une voiture", new_car_path, class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<style>
  .owner-bookings-container {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 1.5rem;
  }

  .bookings-header {
    margin-bottom: 2rem;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--brand-primary);
    text-decoration: none;
    font-weight: 500;
    margin-bottom: 1rem;
    transition: all 0.3s ease;

    &:hover {
      transform: translateX(-4px);
    }
  }

  .bookings-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--brand-dark);
    margin: 0;
  }

  .bookings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 1.5rem;
  }

  .booking-card {
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(15, 23, 42, 0.1);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;

    &:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(15, 23, 42, 0.15);
    }
  }

  .booking-card-image {
    position: relative;
    height: 200px;
    overflow: hidden;
    background: linear-gradient(135deg, #eef2f7 0%, #dbe5f4 100%);

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .placeholder-image {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      font-size: 3rem;
      color: rgba(37, 99, 235, 0.2);
    }
  }

  .status-badge {
    position: absolute;
    top: 12px;
    right: 12px;
    padding: 0.375rem 0.875rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;

    &[data-status="pending"] {
      background: #fef3c7;
      color: #92400e;
    }

    &[data-status="accepted"] {
      background: #dcfce7;
      color: #15803d;
    }

    &[data-status="rejected"] {
      background: #fee2e2;
      color: #991b1b;
    }

    &[data-status="completed"] {
      background: #e0e7ff;
      color: #3730a3;
    }
  }

  .booking-card-content {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    flex-grow: 1;
  }

  .car-info {
    h3 {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--brand-dark);
      margin: 0;

      span {
        color: var(--brand-primary);
      }
    }

    .location {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #64748b;
      font-size: 0.875rem;
      margin: 0.5rem 0 0;

      i {
        color: var(--brand-accent);
      }
    }
  }

  .booking-details {
    background: #f7f8fb;
    padding: 1rem;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.875rem;

    .detail-label {
      color: #64748b;
      font-weight: 500;
    }

    .detail-value {
      color: var(--brand-dark);
      font-weight: 600;
    }

    &.duration,
    &.total {
      padding-top: 0.5rem;
      border-top: 1px solid #e2e8f0;
    }

    &.total {
      .detail-label {
        font-weight: 700;
        color: var(--brand-dark);
      }

      .detail-value {
        font-size: 1.125rem;
        color: var(--brand-primary);
      }
    }
  }

  .booking-actions {
    display: flex;
    gap: 0.5rem;
  }

  .btn {
    flex: 1;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
    text-align: center;
    font-size: 0.875rem;

    &.btn-secondary {
      background: #f0f4ff;
      color: var(--brand-primary);
      border: 1px solid #dbeafe;

      &:hover {
        background: var(--brand-primary);
        color: white;
      }
    }

    &.btn-success {
      background: #dcfce7;
      color: #15803d;
      border: 1px solid #bbf7d0;

      &:hover {
        background: #15803d;
        color: white;
      }
    }

    &.btn-danger {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #fecaca;

      &:hover {
        background: #991b1b;
        color: white;
      }
    }
  }

  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(15, 23, 42, 0.1);

    .empty-icon {
      font-size: 4rem;
      color: rgba(37, 99, 235, 0.2);
      margin-bottom: 1rem;
    }

    h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--brand-dark);
      margin: 0;
    }

    p {
      color: #64748b;
      margin: 0.5rem 0 1.5rem;
    }
  }

  .pagination-wrapper {
    margin-top: 2rem;
    text-align: center;
  }
</style>
